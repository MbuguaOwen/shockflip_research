# ShockFlip v1.4 - BTC research spec
# Changes from v1.3:
#   - H1: require prior_flow_sign == -1 for entries (filters.prior_flow_sign.enabled=true)
#   - EVERYTHING ELSE unchanged
# Single source of truth for ShockFlip alpha configuration.

data:
  include: data.yaml

slippage_bp: 0.5
fees:
  taker_bp: 1.0

risk:
  atr_window: 60
  cooldown_bars: 10
  long:
    tp_mult: 37.5
    sl_mult: 9.0
  short:
    tp_mult: 15.0
    sl_mult: 6.5

  # Optional BE@1R management (H5/H6 inspired)
  mfe_breakeven:
    enabled: true      # keep OFF by default
    threshold_r: 1.0    # move SL to BE once MFE >= 1R

shock_flip:
  source: "imbalance"
  z_window: 240
  # v1.3 - BTC research spec
  z_band: 2.0
  jump_band: 2.0
  persistence_bars: 3
  persistence_ratio: 0.60  
  dynamic_thresholds:
    enabled: false
    percentile: 0.99
  location_filter:
    donchian_window: 120
    require_extreme: true

# Additional filters are defined but disabled by default.
filters:
  atr_percentile:
    enabled: false
    window: 5000
    low: 0.80
    high: 1.00
  macro_regime:
    enabled: false
  prior_flow_sign:
    enabled: true
    required_sign: -1

  price_flow_div:
    enabled: true       # H2 gate is wired but OFF by default
    # "Dead-zone" for price_flow_div: skip trades where
    #   dead_zone_low < price_flow_div <= dead_zone_high

    dead_zone_low: 0.32    # from bucket 3 left edge (~0.319)
    dead_zone_high: 0.86   # from bucket 3 right edge (~0.857)

session:
  utc_blocks: [[0, 24]]

# Absorption logic placeholder: currently NOT used as entry gate.
ops:
  absorption_opposite_exit_bars: 0

absorption_reversal:
  horizons:
    long:  [12, 18, 60]
    short: [6, 12]

event_study:
  horizons:
    long:  [12, 18, 60]
    short: [6, 12]
  baseline_n_random: 2000





